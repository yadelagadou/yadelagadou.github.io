document.addEventListener('DOMContentLoaded',()=>{const e=document.getElementById('search-results'),t=document.getElementById('marquee-message'),n=document.querySelector('.video-player'),o=document.getElementById('exit-fullscreen'),i=document.getElementById('contact-form'),a=document.getElementById('form-message'),r=document.querySelector('.navbar.burger-menu'),s=document.getElementById('hamburger-icon'),c=document.querySelectorAll('.burger-menu a'),d=document.getElementById('random-video-player'),l=/Android/i.test(navigator.userAgent);l&&document.body.classList.add('android'),emailjs.init('DpXF9WJZjKx7woY-Q');let u=0,m=[];fetch('zap.json').then(e=>e.json()).then(e=>{m=e.videos.map(e=>e.id),p(),v(),f()}).catch(e=>{console.error('Error loading videos:',e)}),fetch('marquee.txt').then(e=>e.text()).then(e=>{t.innerHTML=e}).catch(e=>{console.error('Error loading marquee message:',e),t.innerHTML='Bienvenue sur YADELAGADOU TV! üåü Profitez de nos vid√©os!'});let g;function f(){const e=document.createElement('script');e.src='https://www.youtube.com/iframe_api',document.getElementsByTagName('script')[0].parentNode.insertBefore(e,document.getElementsByTagName('script')[0])}function p(){for(let e=m.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[m[e],m[t]]=[m[t],m[e]]}}function v(){const e=Math.floor(Math.random()*m.length),t=m[e];d.innerHTML=`<h2>Vid√©o al√©atoire</h2><iframe width="560" height="315" src="https://www.youtube.com/embed/${t}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`}window.onYouTubeIframeAPIReady=function(){g=new YT.Player('player',{videoId:m[0],playerVars:{autoplay:1,controls:1},events:{onReady:e=>{e.target.playVideo()},onStateChange:e=>{e.data==YT.PlayerState.ENDED&&(u=(u+1)%m.length,g.loadVideoById(m[u]))}}})},document.getElementById('zaping-link').addEventListener('click',function(){g.loadVideoById(m[0]),u=0,h(n)}),document.getElementById('zaping-link-mobile').addEventListener('click',function(){g.loadVideoById(m[0]),u=0,h(n),r.classList.remove('active')}),fetch('videos.json').then(t=>t.json()).then(t=>{t.forEach(t=>{const n=document.createElement('div');n.classList.add('video-item'),n.setAttribute('data-video-id',t.id),n.innerHTML=`<h3>${t.title}</h3>`,n.addEventListener('click',function(){g.loadVideoById(t.id),h(n)}),e.appendChild(n)})}).catch(e=>{console.error('Error loading videos:',e)}),o.addEventListener('click',function(){document.fullscreenElement&&document.exitFullscreen()}),document.addEventListener('fullscreenchange',function(){document.fullscreenElement?(n.classList.add('full-screen-video'),o.style.display='block'):(n.classList.remove('full-screen-video'),o.style.display='none')}),i.addEventListener('submit',function(e){e.preventDefault(),emailjs.sendForm('service_4qj60a9','template_l3s4mge',i).then(function(e){i.reset(),a.style.display='block',a.textContent='Merci! Votre message a √©t√© envoy√©.',a.classList.remove('error')},function(e){a.style.display='block',a.textContent='Erreur! Votre message n\'a pas pu √™tre envoy√©.',a.classList.add('error')})}),s.addEventListener('click',function(){r.classList.toggle('active')}),c.forEach(e=>{e.addEventListener('click',function(){r.classList.remove('active')})})});function searchVideos(){const e=document.getElementById('search-query').value.toLowerCase();fetch('videos.json').then(t=>t.json()).then(t=>{const n=document.getElementById('search-results');n.innerHTML='',t.filter(t=>t.title.toLowerCase().includes(e)).forEach(e=>{const t=document.createElement('div');t.classList.add('video-item'),t.setAttribute('data-video-id',e.id),t.innerHTML=`<h3>${e.title}</h3>`,t.addEventListener('click',function(){g.loadVideoById(e.id),h(document.querySelector('.video-player'))}),n.appendChild(t)})}).catch(e=>{console.error('Error searching videos:',e)})}function h(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitEnterFullscreen&&e.webkitEnterFullscreen()}function exitFullScreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}
